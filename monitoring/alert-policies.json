[
  {
    "displayName": "High CPU Utilization - Cloud Run Services",
    "documentation": {
      "content": "CPU utilization is above 80% for more than 5 minutes on Cloud Run services. This may indicate performance issues or the need for scaling.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Cloud Run CPU > 80%",
        "conditionThreshold": {
          "filter": "resource.type=\"cloud_run_revision\" AND resource.labels.service_name=~\"bahtsulmasail-tech-.*\" AND metric.type=\"run.googleapis.com/container/cpu/utilizations\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 0.8,
          "duration": "300s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_MEAN",
              "crossSeriesReducer": "REDUCE_MEAN",
              "groupByFields": [
                "resource.labels.service_name",
                "resource.labels.revision_name"
              ]
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "WARNING"
  },
  {
    "displayName": "High Memory Utilization - Cloud Run Services",
    "documentation": {
      "content": "Memory utilization is above 85% for more than 5 minutes on Cloud Run services. This may indicate memory leaks or insufficient memory allocation.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Cloud Run Memory > 85%",
        "conditionThreshold": {
          "filter": "resource.type=\"cloud_run_revision\" AND resource.labels.service_name=~\"bahtsulmasail-tech-.*\" AND metric.type=\"run.googleapis.com/container/memory/utilizations\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 0.85,
          "duration": "300s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_MEAN",
              "crossSeriesReducer": "REDUCE_MEAN",
              "groupByFields": [
                "resource.labels.service_name",
                "resource.labels.revision_name"
              ]
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "WARNING"
  },
  {
    "displayName": "High Server Error Rate - 5xx Responses",
    "documentation": {
      "content": "HTTP 5xx error rate is above 5% for more than 2 minutes. This indicates server-side errors that need immediate attention.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Cloud Run 5xx Error Rate > 5%",
        "conditionThreshold": {
          "filter": "resource.type=\"cloud_run_revision\" AND resource.labels.service_name=~\"bahtsulmasail-tech-.*\" AND metric.type=\"run.googleapis.com/request_count\" AND metric.labels.response_code_class=\"5xx\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 0.05,
          "duration": "120s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_RATE",
              "crossSeriesReducer": "REDUCE_SUM",
              "groupByFields": [
                "resource.labels.service_name",
                "metric.labels.response_code_class"
              ]
            }
          ],
          "denominatorFilter": "resource.type=\"cloud_run_revision\" AND resource.labels.service_name=~\"bahtsulmasail-tech-.*\" AND metric.type=\"run.googleapis.com/request_count\"",
          "denominatorAggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_RATE",
              "crossSeriesReducer": "REDUCE_SUM",
              "groupByFields": [
                "resource.labels.service_name"
              ]
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "CRITICAL"
  },
  {
    "displayName": "High Response Latency - Cloud Run",
    "documentation": {
      "content": "95th percentile response latency is above 2 seconds for more than 5 minutes. This may indicate performance degradation.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Cloud Run Latency > 2s (95th percentile)",
        "conditionThreshold": {
          "filter": "resource.type=\"cloud_run_revision\" AND resource.labels.service_name=~\"bahtsulmasail-tech-.*\" AND metric.type=\"run.googleapis.com/request_latencies\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 2000,
          "duration": "300s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_DELTA",
              "crossSeriesReducer": "REDUCE_PERCENTILE_95",
              "groupByFields": [
                "resource.labels.service_name"
              ]
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "WARNING"
  },
  {
    "displayName": "Cloud SQL High Connection Count",
    "documentation": {
      "content": "Cloud SQL connection count is above 80 connections for more than 5 minutes. This may indicate connection leaks or high load.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Cloud SQL Connections > 80",
        "conditionThreshold": {
          "filter": "resource.type=\"cloudsql_database\" AND resource.labels.database_id=\"bahtsul-masail-457713:us-central1:lbmdb\" AND metric.type=\"cloudsql.googleapis.com/database/postgresql/num_backends\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 80,
          "duration": "300s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_MEAN",
              "crossSeriesReducer": "REDUCE_MEAN"
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "WARNING"
  },
  {
    "displayName": "Cloud SQL High CPU Utilization",
    "documentation": {
      "content": "Cloud SQL CPU utilization is above 80% for more than 5 minutes. This may indicate the need for database optimization or scaling.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Cloud SQL CPU > 80%",
        "conditionThreshold": {
          "filter": "resource.type=\"cloudsql_database\" AND resource.labels.database_id=\"bahtsul-masail-457713:us-central1:lbmdb\" AND metric.type=\"cloudsql.googleapis.com/database/cpu/utilization\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 0.8,
          "duration": "300s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_MEAN",
              "crossSeriesReducer": "REDUCE_MEAN"
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "WARNING"
  },
  {
    "displayName": "Cloud SQL High Memory Utilization",
    "documentation": {
      "content": "Cloud SQL memory utilization is above 85% for more than 5 minutes. This may indicate insufficient memory allocation or memory-intensive queries.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Cloud SQL Memory > 85%",
        "conditionThreshold": {
          "filter": "resource.type=\"cloudsql_database\" AND resource.labels.database_id=\"bahtsul-masail-457713:us-central1:lbmdb\" AND metric.type=\"cloudsql.googleapis.com/database/memory/utilization\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 0.85,
          "duration": "300s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_MEAN",
              "crossSeriesReducer": "REDUCE_MEAN"
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "WARNING"
  },
  {
    "displayName": "High Application Error Rate",
    "documentation": {
      "content": "Application error rate is above normal levels based on log-based metrics. This indicates application-level issues that need investigation.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Application Errors > 1 per minute",
        "conditionThreshold": {
          "filter": "metric.type=\"logging.googleapis.com/user/application_errors\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 1,
          "duration": "300s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_RATE",
              "crossSeriesReducer": "REDUCE_SUM"
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "WARNING"
  },
  {
    "displayName": "Service Uptime Check Failure",
    "documentation": {
      "content": "Uptime check for BahtsulMasail.tech services has failed. This indicates potential service outage or connectivity issues.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Uptime Check Failed",
        "conditionThreshold": {
          "filter": "metric.type=\"monitoring.googleapis.com/uptime_check/check_passed\" AND resource.type=\"uptime_url\"",
          "comparison": "COMPARISON_EQUAL",
          "thresholdValue": 0,
          "duration": "60s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_FRACTION_TRUE",
              "crossSeriesReducer": "REDUCE_MEAN",
              "groupByFields": [
                "resource.labels.host"
              ]
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "CRITICAL"
  },
  {
    "displayName": "Redis Memory Usage High",
    "documentation": {
      "content": "Redis memory usage is above 85% for more than 5 minutes. This may indicate the need for memory optimization or scaling.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Redis Memory > 85%",
        "conditionThreshold": {
          "filter": "resource.type=\"memorystore_redis_instance\" AND metric.type=\"redis.googleapis.com/stats/memory/usage_ratio\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 0.85,
          "duration": "300s",
          "aggregations": [
            {
              "alignmentPeriod": "60s",
              "perSeriesAligner": "ALIGN_MEAN",
              "crossSeriesReducer": "REDUCE_MEAN"
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "WARNING"
  },
  {
    "displayName": "Cloud Storage Usage High",
    "documentation": {
      "content": "Cloud Storage usage has exceeded 80% of allocated quota. Consider implementing data lifecycle policies or increasing storage allocation.",
      "mimeType": "text/markdown"
    },
    "conditions": [
      {
        "displayName": "Storage Usage > 80% of quota",
        "conditionThreshold": {
          "filter": "resource.type=\"gcs_bucket\" AND resource.labels.bucket_name=\"lbmbucket\" AND metric.type=\"storage.googleapis.com/storage/total_bytes\"",
          "comparison": "COMPARISON_GREATER_THAN",
          "thresholdValue": 85899345920,
          "duration": "600s",
          "aggregations": [
            {
              "alignmentPeriod": "300s",
              "perSeriesAligner": "ALIGN_MEAN",
              "crossSeriesReducer": "REDUCE_MEAN"
            }
          ]
        }
      }
    ],
    "combiner": "OR",
    "enabled": true,
    "notificationChannels": [
      "projects/bahtsul-masail-457713/notificationChannels/NOTIFICATION_CHANNEL_ID"
    ],
    "severity": "WARNING"
  }
] 